# QZone Auto Login Helper

一个用于 QQ 空间登录流程的辅助脚本（Tampermonkey/Violentmonkey），在登录失效或离线后自动协助恢复登录，保障后续自动化脚本的稳定运行。

## 功能特性

- 点击头像登录：在支持头像快捷登录的页面上，自动查找并点击头像元素完成登录。
- 账户密码登录：支持在登录页中直接填入你在控制面板保存的账号与密码，并触发表单提交。
- 浏览器自动填充（已弃用但保留选项）：仅保留为兼容少数环境；不再主动模拟选择建议与轮询检测，若两字段已有值则直接提交。
- 跨域登录页跳转：若登录表单在不可访问的跨域 iframe 中（如 `ptlogin2.qq.com`），自动跳转到同源登录页再进行密码登录。
- 控制面板：
  - 登录分组（🔐）：选择登录方式、保存/清除本地凭据、禁用回退、临时标准化字段名等。
  - 高级分组（⚙️）：可选“优先登录页URL”，在无法自动识别登录地址时使用。
  - 外观分组（🎨）：状态栏与面板的颜色与风格设置。
- 状态栏提示：显示当前步骤、跳转确认与登录成功提示。

## 安装与运行环境

- 需要浏览器扩展：Tampermonkey 或 Violentmonkey。
- 推荐浏览器：Chromium 内核（Chrome/Edge 等）。
- 脚本匹配域：
  - `*://*.qzone.qq.com/*`
  - `https://i.qq.com/*`
  - `*://*.ptlogin2.qq.com/*`

### 安装方式

1. 打开 Tampermonkey（或 Violentmonkey）控制台。
2. 新建脚本，将 `qzone-auto-login-helper.user.js` 内容粘贴进去并保存。
3. 在匹配域页面打开控制面板（页面右下角“控制面板”按钮），配置登录方式与凭据。

## 使用指南

1. 在“登录”分组保存你的 QQ 账号与密码，并选择“使用保存的账户密码登录”。
2. 点击“测试密码登录”：
   - 若当前页面嵌入了不可访问的跨域登录 iframe，脚本会跳转到对应的登录页（如 `xui.ptlogin2.qq.com`）。
   - 在同源登录页，脚本自动填入并提交表单；若出现验证码，请手动完成。
3. 若页面支持头像快捷登录，可选择“点击头像快捷登录”。
4. 若保留使用“浏览器自动填充（已弃用）”，脚本仅触发基本输入事件；在检测到两字段已有值时会直接提交。

## 配置项（localStorage 键）

- `lh-loginMethod`：登录方式（`autofill`、`avatar`、`saved`）。
- `lh-disableFallback`：是否禁用回退（仅尝试所选方式）。
- `lh-standardizeNames`：临时标准化字段名（提交前自动还原）。
- `lh-checkInterval`：检测登录状态的间隔（秒）。
- `lh-autoTriggerThreshold`：自动触发登录尝试的失败次数阈值。
- `lh-statusBgColor`、`lh-statusTextColor`：状态栏颜色配置。
- `lh-menuBgColor`、`lh-menuTextColor`：控制面板颜色配置。
- `lh-savedUsername`、`lh-savedPassword`：本地保存的账号与密码（仅保存在浏览器 localStorage）。
- `lh-preferredLoginUrl`：优先登录页 URL（可选）。

## 安全与隐私

- 脚本不收集、不上传、也不向任何服务器发送你的账号与密码。
- 本地凭据仅保存在浏览器 `localStorage`，默认不加密；请在私人设备上使用，并妥善管理浏览器数据。
- 你可以在控制面板点击“清除本地保存的账号与密码”一键清理。
- 详见《隐私政策》（`PRIVACY.md`）。

## 开源协议

- 本脚本以 MIT 许可证开源，详见 `LICENSE` 文件。

## 贡献

- 欢迎提出 Issue、提交 Pull Request 或功能建议。
- 适配特定登录页：请提供登录页 URL 与关键元素（账号、密码、提交按钮的选择器），我会做精确优化。

## 免责声明

- 本脚本仅作为登录辅助工具，不保证在所有站点版本与所有浏览器环境下百分百可用。
- 如遇验证码或安全策略拦截，需人工配合完成。